# ğŸ¨ Email Auto-Reply System - Complete Visual Guide

## ğŸ“Š System Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         YOUR GMAIL ACCOUNT                          â”‚
â”‚                     (customer@example.com)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ New Email Arrives
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      EMAIL MONITOR SERVICE                          â”‚
â”‚                     (email_monitor.py)                              â”‚
â”‚                                                                     â”‚
â”‚  - Checks inbox every 60 seconds                                   â”‚
â”‚  - Connects via IMAP (imap.gmail.com)                              â”‚
â”‚  - Fetches unread emails                                           â”‚
â”‚  - Marks as read after processing                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Email Data
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        CREWAI PROCESSING                            â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  STEP 1: Intent Detection Agent                              â”‚ â”‚
â”‚  â”‚  - Analyzes email subject & body                             â”‚ â”‚
â”‚  â”‚  - Identifies intent:                                        â”‚ â”‚
â”‚  â”‚    â€¢ refund_request                                          â”‚ â”‚
â”‚  â”‚    â€¢ support_request                                         â”‚ â”‚
â”‚  â”‚    â€¢ complaint                                               â”‚ â”‚
â”‚  â”‚    â€¢ general_inquiry                                         â”‚ â”‚
â”‚  â”‚    â€¢ spam                                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                             â”‚                                       â”‚
â”‚                             â†“                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  STEP 2: Classification Agent                                â”‚ â”‚
â”‚  â”‚  - Decides action based on intent:                           â”‚ â”‚
â”‚  â”‚    â€¢ AUTO_REPLY (simple queries)                             â”‚ â”‚
â”‚  â”‚    â€¢ TAG_ARCHIVE (just tag & save)                           â”‚ â”‚
â”‚  â”‚    â€¢ ESCALATE (complex issues)                               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                             â”‚                                       â”‚
â”‚                             â†“                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  STEP 3: Action Execution                                    â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  IF AUTO_REPLY:                                              â”‚ â”‚
â”‚  â”‚    â†’ Auto Reply Agent generates response                     â”‚ â”‚
â”‚  â”‚    â†’ Email Service sends reply                               â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  IF TAG_ARCHIVE:                                             â”‚ â”‚
â”‚  â”‚    â†’ Tagging Service assigns tags                            â”‚ â”‚
â”‚  â”‚    â†’ Email archived                                          â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  IF ESCALATE:                                                â”‚ â”‚
â”‚  â”‚    â†’ Escalation Service creates summary                      â”‚ â”‚
â”‚  â”‚    â†’ Notifies human agent                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ AUTO_REPLY Action
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        EMAIL SERVICE                                â”‚
â”‚                     (email_service.py)                              â”‚
â”‚                                                                     â”‚
â”‚  - Connects to Gmail SMTP (smtp.gmail.com:587)                     â”‚
â”‚  - Sends reply email                                               â”‚
â”‚  - Uses TLS encryption                                             â”‚
â”‚  - Logs all operations                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ Reply Email Sent
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CUSTOMER'S INBOX                               â”‚
â”‚                  (Receives auto-reply! ğŸ‰)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Complete Workflow - Step by Step

### 1ï¸âƒ£ Customer Sends Email
```
From: customer@example.com
To: your-email@gmail.com
Subject: Need refund for order #12345
Body: I want to return my product and get a refund
```

### 2ï¸âƒ£ Email Monitor Detects
```
[2025-01-14 11:45:00] ğŸ” Checking for unread emails...
[2025-01-14 11:45:01] ğŸ“¬ Found 1 unread email(s)
[2025-01-14 11:45:01] ğŸ“§ Processing: Need refund for order #12345
```

### 3ï¸âƒ£ AI Analysis
```
Intent Agent: "This is a refund_request"
Classification Agent: "Simple refund query â†’ AUTO_REPLY"
```

### 4ï¸âƒ£ Reply Generation
```
Auto Reply Agent generates:
-----------------------------------
Dear Customer,

Thank you for contacting us regarding your refund request 
for order #12345.

We understand you'd like to return your product. Here's 
what you need to do:

1. Visit our returns portal: returns.yourcompany.com
2. Enter your order number: #12345
3. Follow the return instructions
4. Your refund will be processed within 5-7 business days

If you need further assistance, please don't hesitate to 
reach out.

Best regards,
Customer Support Team
-----------------------------------
```

### 5ï¸âƒ£ Email Sent
```
[2025-01-14 11:45:05] âœ… Sent auto-reply to: customer@example.com
[2025-01-14 11:45:05] âœ… Completed processing: Need refund for order #12345
```

### 6ï¸âƒ£ Customer Receives Reply
```
Customer inbox: New email from your-email@gmail.com
Subject: Re: Need refund for order #12345
```

---

## ğŸ—‚ï¸ Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Email     â”‚
â”‚   Arrives   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   IMAP      â”‚â”€â”€â”€â”€â†’â”‚  Parse Email â”‚
â”‚  Fetcher    â”‚     â”‚   Content    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Intent      â”‚
                    â”‚  Detection   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Classify     â”‚
                    â”‚ Action       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â†“                â†“                â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   AUTO   â”‚    â”‚   TAG    â”‚    â”‚ ESCALATE â”‚
    â”‚  REPLY   â”‚    â”‚ ARCHIVE  â”‚    â”‚          â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚               â”‚
         â†“               â†“               â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Send    â”‚    â”‚   Tag    â”‚    â”‚  Notify  â”‚
    â”‚  Email   â”‚    â”‚   Email  â”‚    â”‚  Human   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Security Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  YOUR GMAIL ACCOUNT                         â”‚
â”‚                                             â”‚
â”‚  1. Enable 2-Step Verification              â”‚
â”‚     â””â†’ Required for App Password            â”‚
â”‚                                             â”‚
â”‚  2. Generate App Password                   â”‚
â”‚     â””â†’ 16-digit password                    â”‚
â”‚                                             â”‚
â”‚  3. Store in .env file                      â”‚
â”‚     â””â†’ Never commit to Git!                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EMAIL SERVICE AUTHENTICATION               â”‚
â”‚                                             â”‚
â”‚  IMAP Connection:                           â”‚
â”‚  - Host: imap.gmail.com                     â”‚
â”‚  - SSL/TLS: Yes                             â”‚
â”‚  - Auth: App Password                       â”‚
â”‚                                             â”‚
â”‚  SMTP Connection:                           â”‚
â”‚  - Host: smtp.gmail.com                     â”‚
â”‚  - Port: 587                                â”‚
â”‚  - TLS: StartTLS                            â”‚
â”‚  - Auth: App Password                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‚ File Structure with Responsibilities

```
Email Cleaner Agentic CrewAI/
â”‚
â”œâ”€â”€ ğŸ”§ Configuration Files
â”‚   â”œâ”€â”€ .env                      â†’ Your credentials & settings
â”‚   â””â”€â”€ .env.example              â†’ Template for .env
â”‚
â”œâ”€â”€ ğŸ§ª Test Files
â”‚   â”œâ”€â”€ test_emails.py            â†’ Pytest unit tests
â”‚   â””â”€â”€ test_email_send.py        â†’ Manual email send test
â”‚
â”œâ”€â”€ ğŸ¤– Email Monitor
â”‚   â””â”€â”€ email_monitor.py          â†’ Automatic inbox checker
â”‚
â”œâ”€â”€ ğŸ“š Documentation
â”‚   â”œâ”€â”€ QUICK_START_BANGLA.md     â†’ 5-minute setup guide
â”‚   â”œâ”€â”€ EMAIL_SETUP_COMPLETE_GUIDE.md â†’ Detailed guide
â”‚   â”œâ”€â”€ SUMMARY_REPORT.md         â†’ What was fixed
â”‚   â””â”€â”€ VISUAL_GUIDE.md           â†’ This file!
â”‚
â””â”€â”€ ğŸ“¦ app/
    â”‚
    â”œâ”€â”€ main.py                   â†’ FastAPI application
    â”‚
    â”œâ”€â”€ api/                      â†’ API Endpoints
    â”‚   â””â”€â”€ email_webhook.py      â†’ Email processing endpoint
    â”‚
    â”œâ”€â”€ crew/                     â†’ AI Agents
    â”‚   â”œâ”€â”€ agents.py             â†’ Agent definitions
    â”‚   â”œâ”€â”€ tasks.py              â†’ Task definitions
    â”‚   â””â”€â”€ crew.py               â†’ Workflow orchestration
    â”‚
    â”œâ”€â”€ services/                 â†’ Business Logic
    â”‚   â”œâ”€â”€ email_service.py      â†’ â­ Gmail integration (NEW!)
    â”‚   â”œâ”€â”€ tagging_service.py    â†’ Email tagging
    â”‚   â””â”€â”€ escalation_service.py â†’ Escalation handling
    â”‚
    â”œâ”€â”€ schemas/                  â†’ Data Models
    â”‚   â””â”€â”€ email_schema.py       â†’ Email data structure
    â”‚
    â””â”€â”€ utils/                    â†’ Utilities
        â”œâ”€â”€ config.py             â†’ Configuration
        â””â”€â”€ logger.py             â†’ Logging
```

---

## ğŸ¯ Intent Detection Examples

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Intent: refund_request                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Examples:                                                  â”‚
â”‚  - "I want a refund for my order"                          â”‚
â”‚  - "How do I return this product?"                         â”‚
â”‚  - "I need my money back"                                  â”‚
â”‚  - "Cancel order and refund me"                            â”‚
â”‚                                                             â”‚
â”‚  Action: AUTO_REPLY                                         â”‚
â”‚  Reply: Refund policy + return instructions                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Intent: support_request                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Examples:                                                  â”‚
â”‚  - "How does this feature work?"                           â”‚
â”‚  - "I need help setting up"                                â”‚
â”‚  - "Can you explain the warranty?"                         â”‚
â”‚  - "What's your return policy?"                            â”‚
â”‚                                                             â”‚
â”‚  Action: AUTO_REPLY                                         â”‚
â”‚  Reply: Help documentation + KB articles                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Intent: complaint                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Examples:                                                  â”‚
â”‚  - "This is unacceptable service!"                         â”‚
â”‚  - "I demand to speak to a manager"                        â”‚
â”‚  - "Very disappointed with your company"                   â”‚
â”‚  - "This is the worst experience ever"                     â”‚
â”‚                                                             â”‚
â”‚  Action: ESCALATE                                           â”‚
â”‚  Reply: None (human agent will respond)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Intent: general_inquiry                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Examples:                                                  â”‚
â”‚  - "Do you ship to Bangladesh?"                            â”‚
â”‚  - "What payment methods do you accept?"                   â”‚
â”‚  - "Are there any discounts available?"                    â”‚
â”‚  - "Tell me about your products"                           â”‚
â”‚                                                             â”‚
â”‚  Action: AUTO_REPLY                                         â”‚
â”‚  Reply: FAQ answers + product info                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš™ï¸ Configuration Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    .env FILE                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  [Application Settings]                                â”‚
â”‚  APP_ENV=local                                          â”‚
â”‚  LOG_LEVEL=INFO                                         â”‚
â”‚                                                         â”‚
â”‚  [Database]                                            â”‚
â”‚  DATABASE_URL=sqlite:///./emailcleaner.db              â”‚
â”‚                                                         â”‚
â”‚  [LLM (LM Studio)]                                     â”‚
â”‚  LLM_PROVIDER=lmstudio                                 â”‚
â”‚  LLM_BASE_URL=http://localhost:1234/v1                â”‚
â”‚  LLM_MODEL=liquid/lfm2-1.2b                            â”‚
â”‚  LLM_TEMPERATURE=0.2                                   â”‚
â”‚  LLM_TIMEOUT=300                                       â”‚
â”‚                                                         â”‚
â”‚  [Email (Gmail)]                                       â”‚
â”‚  EMAIL_PROVIDER=gmail                                  â”‚
â”‚  EMAIL_IMAP_HOST=imap.gmail.com                        â”‚
â”‚  EMAIL_SMTP_HOST=smtp.gmail.com                        â”‚
â”‚  EMAIL_SMTP_PORT=587                                   â”‚
â”‚  EMAIL_USER=your-email@gmail.com      â† SET THIS!     â”‚
â”‚  EMAIL_PASSWORD=app-password-16-digit â† SET THIS!     â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             SYSTEM CONFIGURATION                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  email_monitor.py:                                     â”‚
â”‚    CHECK_INTERVAL = 60 seconds                         â”‚
â”‚                                                         â”‚
â”‚  email_service.py:                                     â”‚
â”‚    â†’ Uses EMAIL_USER & EMAIL_PASSWORD                  â”‚
â”‚    â†’ Connects to IMAP for receiving                    â”‚
â”‚    â†’ Connects to SMTP for sending                      â”‚
â”‚                                                         â”‚
â”‚  crew/crew.py:                                         â”‚
â”‚    â†’ Uses LLM_BASE_URL for AI                          â”‚
â”‚    â†’ Uses LLM_MODEL for processing                     â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§ª Testing Workflow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TEST 1: Email Sending Test                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  Run: python test_email_send.py                         â”‚
â”‚                                                          â”‚
â”‚  What it does:                                          â”‚
â”‚  1. Creates a test email                                â”‚
â”‚  2. Sends email to yourself                             â”‚
â”‚  3. Verifies SMTP connection works                      â”‚
â”‚  4. Checks if email is delivered                        â”‚
â”‚                                                          â”‚
â”‚  Expected Result:                                       â”‚
â”‚  âœ… "Email sent successfully!"                          â”‚
â”‚  ğŸ“¬ You receive test email in inbox                     â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TEST 2: Email Processing Test                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  Run: python email_monitor.py                           â”‚
â”‚                                                          â”‚
â”‚  What it does:                                          â”‚
â”‚  1. Monitors inbox every 60 seconds                     â”‚
â”‚  2. Fetches unread emails                               â”‚
â”‚  3. Processes through CrewAI                            â”‚
â”‚  4. Sends auto-replies                                  â”‚
â”‚                                                          â”‚
â”‚  Test by:                                               â”‚
â”‚  1. Send yourself an email                              â”‚
â”‚  2. Subject: "Need refund"                              â”‚
â”‚  3. Wait 60 seconds                                     â”‚
â”‚  4. Check for auto-reply                                â”‚
â”‚                                                          â”‚
â”‚  Expected Result:                                       â”‚
â”‚  âœ… Email processed                                     â”‚
â”‚  âœ… Auto-reply sent                                     â”‚
â”‚  ğŸ“¬ You receive reply                                   â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TEST 3: Unit Tests (Pytest)                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  Run: pytest test_emails.py -v                          â”‚
â”‚                                                          â”‚
â”‚  What it tests:                                         â”‚
â”‚  1. API endpoint functionality                          â”‚
â”‚  2. Different email types                               â”‚
â”‚  3. Correct action classification                       â”‚
â”‚  4. Response format validation                          â”‚
â”‚                                                          â”‚
â”‚  Test Cases:                                            â”‚
â”‚  âœ… Refund Request â†’ AUTO_REPLY                         â”‚
â”‚  âœ… Shipping Question â†’ AUTO_REPLY                      â”‚
â”‚  âœ… Complaint â†’ ESCALATE                                â”‚
â”‚  âœ… General Inquiry â†’ AUTO_REPLY                        â”‚
â”‚                                                          â”‚
â”‚  Expected Result:                                       â”‚
â”‚  ====== 4 passed in 5.23s ======                        â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Performance Monitoring

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  METRICS YOU CAN TRACK                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                        â”‚
â”‚  ğŸ“ˆ Email Volume:                                      â”‚
â”‚  - Total emails received per day                      â”‚
â”‚  - Emails processed successfully                      â”‚
â”‚  - Failed processing attempts                         â”‚
â”‚                                                        â”‚
â”‚  ğŸ¤– AI Performance:                                    â”‚
â”‚  - Intent detection accuracy                          â”‚
â”‚  - AUTO_REPLY rate (%)                                â”‚
â”‚  - ESCALATE rate (%)                                  â”‚
â”‚  - TAG_ARCHIVE rate (%)                               â”‚
â”‚                                                        â”‚
â”‚  â±ï¸ Response Time:                                     â”‚
â”‚  - Average processing time                            â”‚
â”‚  - Time from email arrival to reply sent              â”‚
â”‚  - LLM response time                                  â”‚
â”‚                                                        â”‚
â”‚  âœ… Quality Metrics:                                   â”‚
â”‚  - Customer satisfaction                              â”‚
â”‚  - Reply accuracy                                     â”‚
â”‚  - False positive rate                                â”‚
â”‚                                                        â”‚
â”‚  ğŸ”§ System Health:                                     â”‚
â”‚  - SMTP connection uptime                             â”‚
â”‚  - IMAP connection uptime                             â”‚
â”‚  - LM Studio availability                             â”‚
â”‚  - Error rate                                         â”‚
â”‚                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Quick Reference - Commands

```bash
# Setup
pip install -r requirements.txt

# Test email sending
python test_email_send.py

# Start FastAPI server
uvicorn app.main:app --reload --port 8000

# Start email monitor
python email_monitor.py

# Run pytest
pytest test_emails.py -v

# Start dashboard
streamlit run dashboard/app.py

# Check logs
tail -f logs/email_cleaner.log

# Clear pytest cache
pytest --cache-clear
```

---

## ğŸ‰ SUCCESS! à¦†à¦ªà¦¨à¦¾à¦° System Ready!

à¦¯à¦¦à¦¿ à¦†à¦ªà¦¨à¦¿ à¦à¦‡ à¦¸à¦¬ steps follow à¦•à¦°à§‡à¦¨, à¦¤à¦¾à¦¹à¦²à§‡ à¦†à¦ªà¦¨à¦¾à¦° **AI-powered Email Auto-Reply System** à¦¸à¦®à§à¦ªà§‚à¦°à§à¦£ à¦•à¦¾à¦œ à¦•à¦°à¦›à§‡! ğŸš€

---

**Need more help? à¦¦à§‡à¦–à§à¦¨:**
- `QUICK_START_BANGLA.md` - Quick setup
- `EMAIL_SETUP_COMPLETE_GUIDE.md` - Detailed guide
- `SUMMARY_REPORT.md` - What was fixed

